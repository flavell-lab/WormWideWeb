services:  
  django:
    build:
      context: .
      dockerfile: Dockerfile
      secrets:
        - env_base
        - env_build_override
    container_name: dj
    command: >
      sh -c "gunicorn wormwideweb.wsgi:application --bind 0.0.0.0:8000"
    image: wormwideweb/gcp_deploy
    ports:
      - "8000:8000"
    env_file:
      - ./config/default.env
secrets:
  env_base:
    file: ./config/default.env
  env_build_override:
    file: ./config/build_override.env